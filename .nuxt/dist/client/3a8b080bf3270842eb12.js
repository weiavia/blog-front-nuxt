(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{389:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return h}));n(35);var r=n(4),o=(n(23),n(215),n(147)),c=n(11),d=n(152),l=n(17),m={filters:{time:function(t){var time=Object(o.b)(t);return"".concat(time.year,"年").concat(time.month,"月").concat(time.day,"日 ").concat(time.hour,":").concat(time.minute,":").concat(time.second)},className:function(t){var e=c.c.find((function(e){if(e.type==t)return e}));return e?e.name:"null"}}},h={filters:{sourcePrefix:function(t){return"".concat(d.a,"/static/").concat(t)},time:function(t){var time=Object(o.b)(t);return"".concat(time.month,"月").concat(time.day,"日 ").concat(time.hour,":").concat(time.minute,":").concat(time.second)},timeParagraphFilter:function(t){var time=Object(o.b)(t);return Object(o.g)(time.hour)}},methods:{sourcePrefix:function(t){return t=encodeURIComponent(t),"".concat(d.a,"/static/").concat(t)}}};e.b={methods:{eventPreCheckAuth:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.getItem("token")||(t.preventDefault(),Object(l.a)());case 2:case"end":return e.stop()}}),e)})))()}}}},429:function(t,e,n){var content=n(618);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(7).default)("33260ebf",content,!0,{sourceMap:!1})},617:function(t,e,n){"use strict";var r=n(429);n.n(r).a},618:function(t,e,n){(e=n(6)(!1)).push([t.i,".triangle[data-v-6cc7a252]{width:0;height:0;border:10px solid transparent;border-bottom-color:hsla(0,0%,100%,.2);transform:rotate(-90deg);position:absolute;left:-20px;top:10px}.timeline .main[data-v-6cc7a252]{width:calc(100% - 10px);height:100%}.timeline .main .content[data-v-6cc7a252]{padding-left:40px;padding-bottom:40px;box-sizing:border-box;border-left:1px solid hsla(0,0%,100%,.2)}.main .circle[data-v-6cc7a252]{position:absolute;width:10px;height:10px;background:#fff;border-radius:50%;border:5px solid #058;left:-50px;top:10px}.main .textarea[data-v-6cc7a252]{position:relative;z-index:200;width:100%;background:hsla(0,0%,100%,.2)}.main .textarea textarea[data-v-6cc7a252]{background:none;width:100%;min-height:80px;border:none;outline:none;padding:10px;box-sizing:border-box}.main .textarea header[data-v-6cc7a252]{line-height:40px;height:40px;padding:0 10px;border-bottom:1px solid #999;overflow:hidden;position:relative}.main .textarea header .area_show[data-v-6cc7a252]{font-size:40px;vertical-align:middle;color:#555;transform:rotate(90deg)}.main .textarea header .file_form[data-v-6cc7a252]{position:absolute;left:-60px;top:-60px;width:100px;height:100px;opacity:0;cursor:pointer;z-index:2}.main .textarea header>.iconfont[data-v-6cc7a252]{margin-right:10px;color:#333}.main .textarea header span[data-v-6cc7a252]{font-size:12px;color:#666}.main .textarea header .writed[data-v-6cc7a252]{font-size:14px;cursor:pointer}.main .item[data-v-6cc7a252]{position:relative;width:100%;background:hsla(0,0%,100%,.2);margin-top:20px;border-radius:4px;padding:10px;box-sizing:border-box;font-size:14px}.main .item header[data-v-6cc7a252]{display:block;padding-bottom:10px;font-size:12px}.main .item header i[data-v-6cc7a252]{font-size:12px}.main .item .text[data-v-6cc7a252]{color:#444;line-height:1.6}.main .half[data-v-6cc7a252]{width:50%}.main .imgs[data-v-6cc7a252]{width:200px;height:200px;border:1px solid #aaa;margin-top:20px;cursor:pointer;position:relative}.main .imgs img[data-v-6cc7a252]{width:100%;height:100%;opacity:0}.main .imgs .tag[data-v-6cc7a252]{position:absolute;color:#fff;padding:2px;right:0;bottom:0;background:hsla(0,0%,100%,.2)}.main .img_tag[data-v-6cc7a252]{font-size:12px;padding:6px;background:hsla(0,0%,100%,.5);display:inline-block;border-radius:0 10px 0 0}.main .img_tag .iconfont[data-v-6cc7a252]{font-size:12px}.nav .wapper[data-v-6cc7a252]{position:relative;display:inline-block;padding-right:40px;padding-bottom:10px}.nav .wapper .year[data-v-6cc7a252]{font-size:14px;margin-bottom:10px;cursor:pointer;padding-top:10px}.nav .wapper .year.active[data-v-6cc7a252]{color:#058}.nav .wapper .month[data-v-6cc7a252]{font-size:12px}.nav .wapper .month p[data-v-6cc7a252]{margin-bottom:5px;text-decoration:underline;cursor:pointer;color:#555}.nav .wapper .month p.active[data-v-6cc7a252]{color:#058}.nav .line[data-v-6cc7a252]{position:absolute;height:100%;width:2px;background:hsla(0,0%,100%,.2);right:0}",""]),t.exports=e},636:function(t,e,n){"use strict";n.r(e);n(35);var r=n(4),o=n(153),c=n(151),d=n(17),l=n(11),m=n(147);function h(param){var t=l.b+"/timeline";return Object(d.b)({url:t,type:"post",data:param})}function v(param){var t=l.b+"/timeline"+Object(m.e)(param);return Object(d.b)({url:t,data:param})}var f=n(389),x={middleware:"common",mixins:[f.c,f.b],asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isDev,t.route,t.store,t.env,t.params,t.query,t.req,t.res,t.redirect,t.error,e.next=3,v();case 3:return n=e.sent,console.log(n),e.abrupt("return",{timelines:n});case 6:case"end":return e.stop()}}),e)})))()},data:function(){return{textareaShow:!0,weather:null,timeParagraph:"",content:"",timelines:[],imgs:[],showarea:!1,page:0}},created:function(){this.timeParagraph=Object(m.g)()},mounted:function(){console.log(this.timelines),this.$refs.file.addEventListener("change",this.uploadImg,!1);var t=this;document.tianqi=function(e){console.log("天气："),console.log(e),t.weather=e};var script=document.createElement("script");document.body.appendChild(script),script.src="https://tianqiapi.com/api?version=v6&appid=42324257&appsecret=CkpQQ6GC&callback=document.tianqi&city=衡阳"},methods:{selectFile:function(t){t.preventDefault()},clearImg:function(){this.imgs=[]},more:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v({page:++t.page});case 2:n=e.sent,t.timelines=t.timelines.concat(n);case 4:case"end":return e.stop()}}),e)})))()},uploadImg:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.target.files,n.next=3,Object(c.d)(r);case 3:o=n.sent,e.imgs=o.data.data;case 5:case"end":return n.stop()}}),n)})))()},submit:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var param;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return param={content:t.content,address:t.weather.city,weather:t.weather.wea+t.weather.tem+"℃",photos:t.imgs},e.next=3,h(param);case 3:e.sent,t.timelines.unshift({content:t.content,address:t.weather.city,weather:t.weather.wea+t.weather.tem,creteTime:(new Date).getTime(),photos:t.imgs}),t.content="",t.imgs="",t.$notify.success({title:"提示",message:"发表成功!",position:"top-right"});case 8:case"end":return e.stop()}}),e)})))()}},components:{Scroll:o.a}},w=(n(617),n(2)),component=Object(w.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("scroll",{staticClass:"timeline clearfix",on:{onEnd:t.more}},[n("div",{staticClass:"main fr"},[n("div",{staticClass:"content"},[n("div",{staticClass:"textarea"},[n("i",{staticClass:"circle"}),t._v(" "),n("header",{staticClass:"clearfix"},[n("div",{staticClass:"fl"},[n("input",{ref:"file",staticClass:"file_form",attrs:{type:"file",multiple:"",accept:"image/gif, image/jpeg, image/png"},on:{click:function(e){return t.eventPreCheckAuth(e)}}}),t._v(" "),n("i",{staticClass:"iconfont icon-tupian pointer",attrs:{title:"插入图片"}}),t._v(" "),n("span",{staticClass:"tianqi"},[t._v("  "),t.weather?n("span",[t._v(" "+t._s(t.weather.city)+" "+t._s(t.weather.wea)+" "+t._s(t.weather.tem)+"℃")]):t._e()]),t._v(" "),n("span",[t._v(t._s(t._f("time")(new Date))+" "+t._s(t.timeParagraph)+" ")])]),t._v(" "),n("div",{staticClass:"fr"},[t.showarea?n("span",{directives:[{name:"show",rawName:"v-show",value:t.textareaShow,expression:"textareaShow"}],staticClass:"writed",on:{click:function(e){t.eventPreCheckAuth(e),t.submit()}}},[t._v("写好了")]):t._e(),t._v(" "),n("i",{staticClass:"iconfont pointer area_show active",class:{"icon-shousuo2":t.showarea,"icon-shousuo1":!t.showarea},on:{click:function(e){t.showarea=!t.showarea}}})])]),t._v(" "),t.showarea?n("div",[n("textarea",{directives:[{name:"show",rawName:"v-show",value:t.textareaShow,expression:"textareaShow"},{name:"model",rawName:"v-model",value:t.content,expression:"content"}],domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),n("footer",[n("p",{directives:[{name:"show",rawName:"v-show",value:this.imgs.length,expression:"this.imgs.length"}],staticClass:"img_tag"},[t._v(t._s(this.imgs.length)+"张图片 "),n("i",{staticClass:"iconfont icon-guanbi pointer",on:{click:t.clearImg}})])])]):t._e()]),t._v(" "),t._l(t.timelines,(function(e){return n("div",{staticClass:"item"},[n("div",{staticClass:"triangle"}),t._v(" "),n("div",{staticClass:"circle"}),t._v(" "),n("header",[n("i",{staticClass:"iconfont icon-tianqi"}),t._v(" "),n("span",[t._v(t._s(e.address)+" "+t._s(e.weather)+",")]),t._v(" "),n("span",[t._v(t._s(t._f("time")(e.creteTime))+" - "+t._s(t._f("timeParagraphFilter")(e.creteTime))+" ")])]),t._v(" "),n("p",{staticClass:"text"},[t._v(t._s(e.content))]),t._v(" "),e.photos[0]&&e.photos[0].src?n("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"imgs",style:{background:"url("+t.sourcePrefix(e.photos[0].src)+") no-repeat center center",backgroundSize:"cover"}},[t._l(e.photos,(function(e){return n("img",{attrs:{src:t._f("sourcePrefix")(e.src)}})})),t._v(" "),n("p",{staticClass:"tag"},[t._v(t._s(e.photos.length)+"张")])],2):t._e()])}))],2)])])}),[],!1,null,"6cc7a252",null);e.default=component.exports}}]);